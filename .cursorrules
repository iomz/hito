# Cursor AI Preferences for this Project

## Commit Message Format

All Git commit messages must follow the [Conventional Changelog](https://github.com/conventional-changelog/conventional-changelog) format:

```text
<type>(<scope>): <subject>

<body>

<footer>
```

Where:

- **type**: The type of change (feat, fix, docs, style, refactor, perf, test, chore, etc.)
- **scope**: Optional - the area of the codebase affected (e.g., ui, core, handlers)
- **subject**: Short description in imperative mood (e.g., "add feature" not "added feature")
- **body**: Optional - detailed explanation of the change
- **footer**: Optional - references to issues, breaking changes, etc.

Example:

```text
feat(ui): add dark mode toggle

Implement dark mode support with toggle in settings panel.
Uses system preferences as default.

Closes #123
```

## Commit Behavior

- **DO NOT** automatically commit changes
- Always let the user review changes first before committing
- Only commit when explicitly requested by the user
- When committing, use the Conventional Changelog format described above

## Package Management

- **Use `pnpm`** for all package management operations (install, add, remove, etc.)
- Do not use `npm` or `yarn` commands
- When suggesting commands, prefer `pnpm` over other package managers

## Code Style

- **Use soft tabs (spaces)** for indentation, never hard tabs
- Follow existing indentation style in the codebase (typically 2 spaces for TypeScript/React files)
- Maintain consistent indentation throughout the project

## Build Verification

- After making changes to the code, run `pnpm run build` to verify that the build passes
- Fix any build errors before considering the task complete
- This ensures TypeScript type checking and build compilation succeed

## Tauri Parameter Naming

- **Important**: Tauri automatically converts Rust `snake_case` parameter names to JavaScript `camelCase`
- When defining Tauri commands in Rust, use `snake_case` for parameters (e.g., `data_file_path: String`)
- When calling Tauri commands from TypeScript, use `camelCase` for the same parameters (e.g., `dataFilePath: value`)
- This conversion happens automatically - do NOT use `camelCase` in Rust or `snake_case` in TypeScript
- Example:
  - Rust: `fn save_data_file_path(app: AppHandle, directory: String, data_file_path: String)`
  - TypeScript: `invokeTauri("save_data_file_path", { directory, dataFilePath })`

## Vitest Test Execution

- **Prevent Zombie Processes**: To prevent zombie processes in Node.js/Vitest (especially in Cursor IDE or CI environments), follow these practices:
  - Use `pnpm test:run` for CI/automated runs instead of `pnpm test` (watch mode)
  - Use `pnpm test:coverage` for coverage reports (uses `vitest run` internally)
  - Use `pnpm test:ci` for CI environments (non-watch mode with coverage)
  - The `vitest.config.ts` is configured with:
    - `pool: "forks"` with `isolate: true` for proper process isolation
    - Timeout configurations (`teardownTimeout`, `hookTimeout`, `testTimeout`) to ensure proper cleanup
  - Watch mode (`pnpm test`) is fine for interactive development, but avoid it in automated scripts
  - Always use `vitest run` or `--watch=false` in CI/Scripted environments to ensure processes terminate cleanly
